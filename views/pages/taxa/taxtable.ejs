<%- include('../../partials/header_html'); %>

<% list = JSON.parse(res) %>
<% statusfltrX = statusfltr %>

<style>
#download_fxn {
  position:absolute;
  right: 90px;
  top:130px;
  font-size:12px;
}
.table-condensed{
  font-size: 13px;
}
#tax-table
{
  padding:5px;
 /*  width:1200px; */
  table-layout:fixed;
}
#tax-table th
{
  color:white;
  background:#006699;
  padding:5px;
  font-size:13px;
  text-align: center;
}
#tax-table td
{
 padding:3px 2px;
  font-size:small;
  color: #303030;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
#tax-table tr:nth-child(even) { 
    background-color: #ffffcd; 
 } 
 #tax-table tr:hover { 
    background-color: #dce7f5; 
 } 

table.sortable th:not(.sorttable_sorted):not(.sorttable_sorted_reverse):not(.sorttable_nosort):after { 
        content: " \25B4\25BE" 
    }
</style>

<body>
  <div id='wrapper'>		
	    
	    
	<div id='header'>
       <%- include('../../partials/header_img'); %>
    </div>

	<%- include('../../partials/navbar'); %>
   
    <div id='' class='page-content'>
      <div class='jumbotron'> 
	
		 <center><h4 class='title text-info'><%= pgtitle %></h4></center>
		 
		 <div id='download_fxn'><b>Download Taxon Table</b>: 
		   <a href='dld_ttable?type=browser' >[Browser]</a>
		   <a href='dld_ttable?type=text' >[Text]</a>
		   <a href='dld_ttable?type=excel' >[Excel]</a>
		 </div>		 
			 
	<%- include('../../partials/tax_table_filter_pt1.ejs') %>

<div id='tax-box' >

	<%- include('../../partials/tax_table_filter_pt2.ejs') %> 
	 
		 
		 <table id='tax-table' class='table table-hover table-condensed sortable' style='background: lightgrey;'>
		 <thead>
		  <tr>
		    <th scope="col" nowrap>Taxon ID</th>
		    <th scope="col">Genus</th>
		    <th scope="col">Species</th>
		    <th scope="col">Status</th>
		    <th scope="col" nowrap>Body Site</th>
		    <th scope="col">Flag</th>
		    <th scope="col" class="sorttable_nosort" nowrap>Taxon Link</th>
		    <th scope="col" class="sorttable_nosort" nowrap>Genome Link</th>
		    <th scope="col" nowrap>Genome Size</th>
		  </tr>
		 </thead>
		 <tbody>
		 <% for(n in list){ %>
		   <tr class="table-primaryX">
		   <% otid= list[n].otid %>
		   <% taxidfullname = 'HMT-'+("000" + otid).slice(-3); %>
		   <td nowrap><%= taxidfullname  %></td>
		   <td nowrap><i><b><%= list[n].genus  %></b></i></td>
		   <td nowrap><i><b><%= list[n].species  %></b></i></td>
		   <td><%= list[n].status  %></td>
		   <td><%= list[n].site  %></td>
		   <td><%= list[n].warning  %></td>
		   <td style='text-align:center' nowrap><a href="tax_description?otid=<%= otid %>" class="badge badge-primary" >Taxon Description</a></td>
		   <td style='text-align:center' nowrap>
		   <% num_genomes = list[n].genomes.length %>
		   <% if(num_genomes === 0){ %>
		     No Genomes
		   <% }else if(num_genomes === 1){ %> 
		    <a href="/genome/genome_table?otid=<%= otid %>" class="badge badge-success" >1 Genome</a>
		   <% }else{ %>
		     
		     <a href="/genome/genome_table?otid=<%= otid %>" class="badge badge-success" ><%= num_genomes %> Genomes</a>
		     
		   <% } %>
		   </td>
		   <td nowrap><%= list[n].gsize  %></td>
		   </tr>
		 <% } %>
		 </tbody>
		 </table>
		 
</div>  <!-- end: tax-box -->
	  </div> <!-- end jumbo -->
    </div> <!-- end: page-content -->
    <div id='footer'>
         <%- include('../../partials/footer'); %>
    </div>
       
   
  </div> <!-- end wrapper -->
</body>

</html>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="/js/taxonomy.js"></script>
<script type="text/javascript" src="/js/bootstrap.js"></script>
<script src="/js/sorttable.js"></script> <!-- https://www.kryogenix.org/code/browser/sorttable -->
<script>
  $(document).ready(function(){                    
    
    var letter = '<%- letter %>'
	var statusfltr= JSON.parse('<%- statusfltr %>')
	var sitefltr= JSON.parse('<%- sitefltr %>')
    // lets set check here
    // uncheck all
    var els = document.getElementsByClassName('filter_ckbx')
    var all_on = statusfltr.concat(sitefltr)
    for (n in els){
		if(all_on.indexOf(els[n].name) != -1){
		  els[n].checked = true
		}
	} 
	if(letter){
		document.getElementById(letter).style.color = 'red'
		document.getElementById(letter).style.fontSize = 'medium'
	}else{
		document.getElementById('all').style.color = 'red'
	}
});

</script>



